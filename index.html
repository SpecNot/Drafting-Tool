<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Image Grid Picker (3×4)</title>
    <meta name="description" content="3×4 image grid inside 1200×660 background, library tabs with filter, extra placements row" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23000'/%3E%3Ctext x='50' y='58' font-size='52' text-anchor='middle' fill='%23fff' font-family='Arial,Helvetica,sans-serif'%3EIG%3C/text%3E%3C/svg%3E" />
    <!-- Tailwind Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Optional: Tailwind config can be extended here if needed
      tailwind.config = {
        theme: { extend: {} }
      }


      
    </script>
    <!-- React + ReactDOM (development) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel Standalone to transpile JSX in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-neutral-50">
    <div id="root"></div>

    <!-- App code (JSX) -->
    <script type="text/babel">
      const { useState, useMemo, useRef, useEffect } = React;

      // --- Utilities ---
      function titleFromUrl(url) {
        try {
          const u = new URL(url);
          const last = u.pathname.split("/").filter(Boolean).pop() || "Image";
          const base = decodeURIComponent(last.split(".")[0]);
          return base.replace(/[-_]+/g, " ").trim();
        } catch {
          return "Image";
        }
      }

      function itemsFromUrls(urls) {
        return urls.map((url) => ({ url, title: titleFromUrl(url) }));
      }

      // --- Defaults ---
      const DEFAULT_IMAGES = [
        "https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1491553895911-0055eca6402d?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1470770841072-f978cf4d019e?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1517816743773-6e0fd518b4a6?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1472214103451-9374bd1c798e?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?q=80&w=1200&auto=format&fit=crop",
      ];

      const DEFAULT_BG = "https://images.unsplash.com/photo-1517816743773-6e0fd518b4a6?q=80&w=1600&auto=format&fit=crop";

      // Filler images for Library 2
      const DEFAULT_IMAGES_2 = [
        "https://images.unsplash.com/photo-1502082553048-f009c37129b9?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1482192596544-9eb780fc7f66?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1504208434309-cb69f4fe52b0?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1482192505345-5655af888cc4?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1499084732479-de2c02d45fc4?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1495562569060-2eec283d3391?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1472214103451-9374bd1c798e?q=80&w=1200&auto=format&fit=crop",
      ];

      const SLOT_COUNT = 12;
      const EXTRA_SLOT_COUNT = 10;

      function App() {
        const [lib1, setLib1] = useState(itemsFromUrls(DEFAULT_IMAGES));
        const [lib2, setLib2] = useState(itemsFromUrls(DEFAULT_IMAGES_2));
        const [activeLib, setActiveLib] = useState(1);
        const [filter, setFilter] = useState("");

        const [selectedLibUrl, setSelectedLibUrl] = useState(null);
        const [bgUrl, setBgUrl] = useState(DEFAULT_BG);

        const [slots, setSlots] = useState(() =>
          Array.from({ length: SLOT_COUNT }, (_, i) => ({ id: i, url: null }))
        );
        const [extraSlots, setExtraSlots] = useState(() =>
          Array.from({ length: EXTRA_SLOT_COUNT }, (_, i) => ({ id: i, url: null }))
        );

        const uploadBgRef = useRef(null);

        const currentLibrary = activeLib === 1 ? lib1 : lib2;
        const setCurrentLibrary = activeLib === 1 ? setLib1 : setLib2;

        const filteredLibrary = useMemo(() => {
          const term = filter.trim().toLowerCase();
          if (!term) return currentLibrary;
          return currentLibrary.filter((item) => item.title.toLowerCase().includes(term));
        }, [currentLibrary, filter]);

        const placeIntoMainSlot = (slotIndex, url) => {
          setSlots((prev) => prev.map((s, i) => (i === slotIndex ? { ...s, url } : s)));
        };
        const clearMainSlot = (slotIndex) => {
          setSlots((prev) => prev.map((s, i) => (i === slotIndex ? { ...s, url: null } : s)));
        };

        const placeIntoExtraSlot = (slotIndex, url) => {
          setExtraSlots((prev) => prev.map((s, i) => (i === slotIndex ? { ...s, url } : s)));
        };

        const clearAll = () => {
          setSlots((prev) => prev.map((s) => ({ ...s, url: null })));
          setExtraSlots((prev) => prev.map((s) => ({ ...s, url: null })));
        };

        const onDropToMain = (e, slotIndex) => {
          e.preventDefault();
          const url = e.dataTransfer.getData("text/uri-list") || e.dataTransfer.getData("text/plain");
          if (url) placeIntoMainSlot(slotIndex, url);
        };
        const onDropToExtra = (e, slotIndex) => {
          e.preventDefault();
          const url = e.dataTransfer.getData("text/uri-list") || e.dataTransfer.getData("text/plain");
          if (url) placeIntoExtraSlot(slotIndex, url);
        };

        const onUploadBg = (files) => {
          if (!files || files.length === 0) return;
          const file = files[0];
          const objectUrl = URL.createObjectURL(file);
          setBgUrl(objectUrl);
        };

        const selectedCount = useMemo(() => slots.filter((s) => !!s.url).length, [slots]);

        return (
          <>
            <div className="min-h-screen w-full bg-neutral-50 text-neutral-900">
              <header className="sticky top-0 z-10 bg-white/80 backdrop-blur border-b border-neutral-200">
                <div className="w-full py-3 flex items-center justify-between px-4">
                  <div className="flex items-center gap-3">
                    <div className="size-8 rounded-xl bg-black/90 flex items-center justify-center text-white font-bold">IG</div>
                    <div>
                      <h1 className="text-lg font-semibold leading-tight">Image Grid Picker (3 × 4)</h1>
                      <p className="text-xs text-neutral-500">Grid inside 1200×660 background (300×400 left). Library tabs & filter below. Extra 10 spaces beneath.</p>
                    </div>
                  </div>
                  <div className="flex items-center gap-2">
                    <button onClick={() => uploadBgRef.current && uploadBgRef.current.click()} className="px-3 py-2 rounded-xl border border-neutral-300 hover:bg-neutral-100 text-sm">Change Background</button>
                    <input ref={uploadBgRef} type="file" accept="image/*" className="hidden" onChange={(e) => onUploadBg(e.target.files)} />
                    <button onClick={clearAll} className="px-3 py-2 rounded-xl bg-neutral-900 text-white text-sm hover:bg-black">Clear All Slots</button>
                  </div>
                </div>
              </header>

              {/* Background stage — NO left/right margins */}
              <section className="w-full py-6">
                <div className="relative w-[1200px] h-[660px] rounded-2xl overflow-hidden border border-neutral-200 bg-neutral-200"
                  style={{ backgroundImage: `url(${bgUrl})`, backgroundSize: "cover", backgroundPosition: "center" }}
                >
                  {/* 300 × 400 grid area pinned left, vertically centered */}
                  <div className="absolute left-6 top-1/2 -translate-y-1/2">
                    <div className="text-xs mb-2 px-2 py-1 inline-block rounded bg-white/80 border border-neutral-200">Grid • {selectedCount}/12</div>
                    <div className="grid grid-cols-3 grid-rows-4 w-[300px] h-[400px] gap-0 bg-white/30 backdrop-blur-[1px] rounded-xl overflow-hidden">
                      {slots.map((slot, i) => (
                        <div key={slot.id} className="relative w-full h-full border border-white/40">
                          {slot.url && (
                            <button className="absolute left-1 top-1 z-10 size-6 rounded-md bg-white/90 hover:bg-white shadow border border-neutral-200 flex items-center justify-center text-[10px]" title="Clear" onClick={(e) => { e.stopPropagation(); clearMainSlot(i); }}>✖</button>
                          )}
                          <div className="absolute inset-0" onClick={() => { if (selectedLibUrl) placeIntoMainSlot(i, selectedLibUrl); }} onDragOver={(e) => e.preventDefault()} onDrop={(e) => onDropToMain(e, i)}>
                            {slot.url ? <img src={slot.url} alt={`Slot ${i + 1}`} className="h-full w-full object-cover" draggable={false} /> : <div className="flex h-full w-full items-center justify-center text-[10px] text-white/80 select-none">click or drop</div>}
                          </div>
                          <div className="absolute right-1 bottom-1 text-[9px] px-1.5 py-0.5 rounded bg-black/60 text-white">{i + 1}</div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </section>

              {/* Extra placements */}
              <section className="w-full pb-6">
                <h2 className="text-sm font-medium text-neutral-700 mb-2 px-4">Extra Placements (10)</h2>
                {/* Single-row layout, items sized to fit within ~1200px width */}
                <div className="flex gap-3 flex-nowrap px-4">
                  {extraSlots.map((slot, i) => (
                    <div
                      key={slot.id}
                      className="relative w-[96px] h-[96px] rounded-xl overflow-hidden border border-neutral-200 bg-white shrink-0"
                      onClick={() => { if (selectedLibUrl) placeIntoExtraSlot(i, selectedLibUrl); }}
                      onDragOver={(e) => e.preventDefault()}
                      onDrop={(e) => onDropToExtra(e, i)}
                    >
                      {slot.url ? (
                        <>
                          <img src={slot.url} alt={`Extra ${i+1}`} className="h-full w-full object-cover" draggable={false} />
                          <button
                            className="absolute left-1 top-1 z-10 size-6 rounded-md bg-white/90 hover:bg-white shadow border border-neutral-200 flex items-center justify-center text-[10px]"
                            title="Clear"
                            onClick={(e) => { e.stopPropagation(); placeIntoExtraSlot(i, null); }}
                          >
                            ✖
                          </button>
                        </>
                      ) : (
                        <div className="absolute inset-0 flex items-center justify-center text-[10px] text-neutral-400 select-none">click or drop</div>
                      )}
                      <div className="absolute right-1 bottom-1 text-[9px] px-1.5 py-0.5 rounded bg-black/60 text-white">{i + 1}</div>
                    </div>
                  ))}
                </div>
              </section>

              {/* Library tabs + FILTER */}
              <section className="w-full pb-10">
                <div className="mb-3 flex flex-wrap items-center gap-3 px-4">
                  <div className="inline-flex rounded-xl border border-neutral-300 overflow-hidden">
                    <button className={\`px-3 py-1.5 text-sm \${activeLib === 1 ? 'bg-neutral-900 text-white' : 'bg-white text-neutral-700 hover:bg-neutral-100'}\`} onClick={() => setActiveLib(1)}>Library 1</button>
                    <button className={\`px-3 py-1.5 text-sm \${activeLib === 2 ? 'bg-neutral-900 text-white' : 'bg-white text-neutral-700 hover:bg-neutral-100'}\`} onClick={() => setActiveLib(2)}>Library 2</button>
                  </div>
                  <div className="relative">
                    <input
                      value={filter}
                      onChange={(e) => setFilter(e.target.value)}
                      placeholder="Filter by title…"
                      className="px-3 py-1.5 rounded-xl border border-neutral-300 text-sm focus:outline-none focus:ring-2 focus:ring-neutral-300"
                    />
                  </div>
                </div>

                <div className="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-3 px-4">
                  {filteredLibrary.map((item, idx) => (
                    <button
                      key={item.url + idx}
                      className={
                        "relative aspect-square rounded-xl overflow-hidden border " +
                        (selectedLibUrl === item.url
                          ? "border-neutral-900 ring-2 ring-neutral-900"
                          : "border-neutral-200 hover:border-neutral-300")
                      }
                      onClick={() => setSelectedLibUrl(item.url)}
                      draggable
                      onDragStart={(e) => {
                        e.dataTransfer.setData("text/uri-list", item.url);
                        e.dataTransfer.setData("text/plain", item.url);
                      }}
                      title={item.title}
                    >
                      <img src={item.url} alt={item.title} className="h-full w-full object-cover" />
                      <div className="absolute left-0 right-0 bottom-0 text-[10px] px-1.5 py-1 bg-black/50 text-white line-clamp-1 text-left">
                        {item.title}
                      </div>
                      {selectedLibUrl === item.url && (
                        <div className="absolute inset-0 ring-4 ring-inset ring-black/20 pointer-events-none" />
                      )}
                    </button>
                  ))}
                  {filteredLibrary.length === 0 && (
                    <div className="col-span-full text-xs text-neutral-500">No images match “{filter}”.</div>
                  )}
                </div>

                <footer className="mt-10 text-xs text-neutral-500 px-4">Background fixed at 1200×660; grid 300×400 on left; 10 extra slots below. Two library tabs with title filter.</footer>
              </section>
            </div>
          </>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
